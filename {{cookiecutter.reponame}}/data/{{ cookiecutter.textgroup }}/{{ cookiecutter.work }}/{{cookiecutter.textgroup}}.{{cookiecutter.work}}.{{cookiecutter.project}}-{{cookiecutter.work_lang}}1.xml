{% macro _textpart(levels) -%}
            <div type="textpart" subtype="{{levels[0]}}" n="1">
                {% if levels|length > 1 %}{{ _textpart(levels[1:])|indent(4,true) }}{% else %}
                    <p>
                        If you want to change the tag type of these resources:
                            1 - change the xpath in the cRefPattern tags.
                            2 - Keep the @n attribute
                        The numbering system does not need to be roman number based nor does it need to be sorted.
                    </p>
                {% endif %}
            </div>
{%- endmacro %}<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="http://www.stoa.org/epidoc/schema/latest/tei-epidoc.rng" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="http://www.stoa.org/epidoc/schema/latest/tei-epidoc.rng" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" xml:space="preserve" xml:lang="{{cookiecutter.desc_lang}}">
    <teiHeader>
        <fileDesc>
            <titleStmt>
                <title>{{cookiecutter.edition}}</title>
                <author>{{cookiecutter.tg_name}}</author>
            </titleStmt>
            <publicationStmt>
                <authority></authority>
                <idno type="filename"></idno>
            </publicationStmt>
            <sourceDesc>
                <p>Source Desc should be completed for Epidoc Compliancy</p>
            </sourceDesc>
        </fileDesc>
        <encodingDesc>
         <projectDesc>
            <p>This document has been pre-generated by <ref target="http://capitains.github.io">CapiTainS Guidelines</ref> Cookiecutter script</p>
         </projectDesc>
         <refsDecl n="CTS">{% for level in cookiecutter.level_edition.lower().split(",")[::-1] %}
            <cRefPattern 
                n="{{level}}"
                matchPattern="{{ (["(\w+)"]*(loop.revindex)) | join(".") }}"
                replacementPattern="#xpath(/tei:TEI/tei:text/tei:body/tei:div{% for i in range(1, loop.revindex+1) %}/tei:div[@n='${{i}}']{% endfor %})">
                <p>This pointer pattern extracts {{cookiecutter.level_edition.lower().split(",")[:loop.revindex] | join(" and ")}}</p>
            </cRefPattern>{% endfor %}
        </refsDecl>
            <refsDecl>
        	{% for level in cookiecutter.level_edition.lower().split(",") %}   <refState unit="{{level}}"/>
            {%endfor%}</refsDecl>
        </encodingDesc>
    </teiHeader>
    <text>
        <body>
            <div type="edition" n="urn:cts:{{cookiecutter.namespace}}:{{cookiecutter.textgroup}}.{{cookiecutter.work}}.{{cookiecutter.project}}-{{cookiecutter.work_lang}}1" xml:lang="{{cookiecutter.work_lang}}">
                {{_textpart(cookiecutter.level_edition.lower().split(","))}}
            </div>
        </body>
    </text>
</TEI>